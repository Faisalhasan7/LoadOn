<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>LoadOn</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        body {
            font-family: 'Inter', sans-serif;
        }

        /* Reusable spinner style */
        .spinner {
            border: 4px solid rgba(0, 0, 0, 0.1);
            border-left-color: #4f46e5;
            /* Using a neutral indigo color */
            border-radius: 50%;
            width: 24px;
            height: 24px;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            0% {
                transform: rotate(0deg);
            }

            100% {
                transform: rotate(360deg);
            }
        }
    </style>
</head>

<body class="bg-gray-100 dark:bg-gray-900 flex md:items-center md:justify-center min-h-screen pt-8 md:pt-0">

    <div class="w-full max-w-md mx-auto p-4">
        <div class="bg-white dark:bg-gray-800 rounded-2xl shadow-lg p-6 md:p-8">
            <div class="text-center mb-6">
                <h1 class="text-2xl md:text-3xl font-bold text-gray-800 dark:text-white">LoadOn Downloader</h1>
                <p class="text-gray-500 dark:text-gray-400 mt-2">Download videos and images from your favorite platforms.</p>
            </div>

            <div class="mb-6">
                <div class="flex border-b border-gray-200 dark:border-gray-700">
                    <button id="tiktok-tab-btn" class="tab-btn flex-1 py-2 px-4 text-center font-semibold rounded-t-lg focus:outline-none flex items-center justify-center gap-x-2 transition-colors duration-300">
                        <svg fill="currentColor" width="30px" height="30px" viewBox="0 0 24 24" id="tiktok" data-name="Line Color" xmlns="http://www.w3.org/2000/svg" class="icon line-color">
                            <path id="primary" d="M21,7H20a4,4,0,0,1-4-4H12V14.5a2.5,2.5,0,1,1-4-2V8.18a6.5,6.5,0,1,0,8,6.32V9.92A8,8,0,0,0,20,11h1Z" style="fill: none; stroke: rgb(0, 0, 0); stroke-linecap: round; stroke-linejoin: round; stroke-width: 2;"></path>
                        </svg>
                        <span>TikTok</span>
                    </button>
                    <button id="vsco-tab-btn" class="tab-btn flex-1 py-2 px-4 text-center font-semibold rounded-t-lg focus:outline-none flex items-center justify-center gap-x-2 transition-colors duration-300">
                        <?xml version="1.0" encoding="utf-8"?>
                        <svg fill="currentColor" width="30px" height="30px" viewBox="0 0 14 14" role="img" focusable="false" aria-hidden="true" xmlns="http://www.w3.org/2000/svg">
                            <path d="M 7,1 C 3.688,1 1,3.688 1,7 c 0,3.312 2.688,6 6,6 3.312,0 6,-2.688 6,-6 C 13,3.688 10.312,1 7,1 Z m 5.76,6 c 0,0.204 -0.0115,0.396 -0.036,0.588 l -1.02,-0.12 C 11.716,7.312 11.729,7.156 11.729,7 c 0,-0.144 -0.0125,-0.3 -0.025,-0.444 l 1.02,-0.12 C 12.76,6.628 12.76,6.808 12.76,7 Z M 1.2395,7 c 0,-0.192 0.012,-0.3845 0.0245,-0.576 l 1.02,0.12 C 2.272,6.7 2.2605,6.844 2.2605,7 c 0,0.156 0.0115,0.3 0.0235,0.456 l -1.02,0.12 C 1.2395,7.3845 1.2395,7.192 1.2395,7 Z m 10.236,-1.548 0.9605,-0.36 c 0.132,0.36 0.2165,0.732 0.276,1.116 l -1.02,0.12 c -0.0485,-0.3 -0.12,-0.6 -0.2165,-0.876 z M 11.5,7 c 0,0.3 -0.036,0.588 -0.0835,0.876 L 10.408,7.6485 C 10.4435,7.444 10.4675,7.228 10.4675,7 c 0,-0.228 -0.024,-0.456 -0.0595,-0.672 L 11.4165,6.0995 C 11.4755,6.388 11.5,6.688 11.5,7 Z M 7,10.228 C 5.2175,10.2275 3.7725,8.7825 3.772,7 3.7725,5.2175 5.2175,3.7725 7,3.772 8.7825,3.7725 10.2275,5.2175 10.228,7 10.232,8.7795 8.7925,10.224 7.0135,10.228 L 7,10.228 Z m 0.108,1.272 0,-1.032 c 0.4425,-0.0145 0.878,-0.112 1.284,-0.2875 l 0.444,0.936 C 8.291,11.3575 7.704,11.4875 7.108,11.5 Z M 5.14,11.1045 5.596,10.168 c 0.396,0.1795 0.828,0.2875 1.284,0.3 l 0,1.032 C 6.279,11.4885 5.687,11.3535 5.14,11.1045 Z M 2.5,7 C 2.5,6.688 2.536,6.388 2.596,6.088 L 3.604,6.316 C 3.555,6.541 3.531,6.77 3.532,7 c 0,0.216 0.024,0.432 0.06,0.636 L 2.584,7.8635 C 2.5255,7.5795 2.497,7.29 2.5,7 Z m 4.38,-4.5 0,1.032 C 6.4415,3.5465 6.01,3.644 5.608,3.82 L 5.164,2.8845 C 5.7055,2.6455 6.2885,2.515 6.88,2.5 Z M 8.8475,2.896 8.392,3.832 C 7.9875,3.6505 7.551,3.5525 7.108,3.544 l 0,-1.032 c 0.624,0 1.212,0.144 1.7395,0.384 z m 2.544,2.328 C 11.276,4.944 11.135,4.675 10.9715,4.42 L 11.812,3.844 c 0.2035,0.324 0.384,0.66 0.528,1.02 l -0.9485,0.36 z M 11.3565,5.872 10.3475,6.1 C 10.2325,5.675 10.037,5.276 9.772,4.924 l 0.816,-0.6475 c 0.36,0.4795 0.624,1.0075 0.7685,1.5955 z M 9.628,4.744 C 9.342,4.4105 8.996,4.134 8.608,3.9275 L 9.064,2.992 c 0.528,0.2745 0.9965,0.6495 1.38,1.104 L 9.628,4.744 Z M 9.328,2.872 9.808,1.96 c 0.336,0.192 0.6475,0.408 0.948,0.66 L 10.0725,3.4 C 9.842,3.1995 9.593,3.023 9.328,2.872 Z M 9.124,2.764 C 8.854,2.631 8.573,2.5225 8.284,2.44 L 8.536,1.444 c 0.372,0.108 0.732,0.24 1.0795,0.42 L 9.124,2.764 Z M 8.044,2.38 C 7.744,2.308 7.444,2.272 7.132,2.2605 l 0,-1.021 c 0.3965,0.012 0.792,0.06 1.164,0.1445 L 8.044,2.38 Z M 6.904,2.2605 C 6.6015,2.271 6.3005,2.3075 6.004,2.3685 L 5.764,1.372 C 6.124,1.288 6.5075,1.2395 6.904,1.2395 l 0,1.021 z m -1.14,0.167 C 5.471,2.511 5.186,2.6195 4.912,2.752 L 4.432,1.84 C 4.7775,1.6685 5.1395,1.532 5.512,1.432 L 5.764,2.4275 Z M 4.708,2.86 C 4.4435,3.007 4.1945,3.18 3.964,3.376 L 3.28,2.608 C 3.58,2.356 3.892,2.14 4.228,1.9485 L 4.708,2.86 Z m 0.24,0.132 0.444,0.9355 c -0.396,0.204 -0.732,0.48 -1.02,0.804 L 3.568,4.084 C 3.9555,3.6365 4.4235,3.266 4.948,2.992 Z M 3.424,4.276 4.228,4.9235 C 3.963,5.276 3.7675,5.675 3.652,6.1 L 2.644,5.872 C 2.8,5.272 3.064,4.732 3.424,4.276 Z M 2.62,5.2 1.66,4.84 C 1.8035,4.48 1.984,4.132 2.2,3.82 L 3.04,4.408 C 2.8695,4.655 2.7285,4.9205 2.62,5.2 Z M 2.536,5.4275 C 2.44,5.716 2.356,6.0035 2.32,6.3155 L 1.3,6.1965 C 1.36,5.812 1.444,5.428 1.5765,5.068 L 2.536,5.4275 Z M 2.308,7.684 c 0.048,0.3 0.1195,0.6 0.216,0.888 l -0.96,0.36 C 1.4285,8.568 1.336,8.1895 1.288,7.8035 L 2.308,7.684 Z M 2.62,8.788 C 2.7395,9.076 2.884,9.34 3.04,9.5915 L 2.2,10.168 C 1.9825,9.8535 1.8015,9.515 1.66,9.16 L 2.62,8.788 Z M 2.632,8.092 3.6405,7.864 c 0.108,0.432 0.312,0.8405 0.564,1.188 L 3.4,9.7 C 3.0375,9.2215 2.7765,8.6745 2.632,8.092 Z m 1.716,1.14 C 4.6365,9.568 4.984,9.856 5.38,10.06 L 4.924,10.996 C 4.3925,10.7175 3.9195,10.3385 3.532,9.88 L 4.348,9.232 Z m 0.36,1.9075 -0.48,0.9125 C 3.891,11.864 3.573,11.6425 3.28,11.3915 L 3.964,10.624 c 0.228,0.2035 0.468,0.372 0.744,0.5155 z m 0.204,0.1085 c 0.264,0.132 0.552,0.24 0.8525,0.3235 l -0.252,0.996 C 5.139,12.4695 4.777,12.333 4.4325,12.16 L 4.912,11.248 Z m 1.08,0.384 c 0.288,0.06 0.588,0.0965 0.9,0.1085 l 0,1.0195 C 6.505,12.747 6.12,12.703 5.7395,12.628 L 5.992,11.632 Z m 1.14,0.108 c 0.3025,-0.0105 0.6035,-0.047 0.9005,-0.1085 l 0.2395,0.996 c -0.3745,0.084 -0.7565,0.132 -1.14,0.1435 l 0,-1.031 z M 8.2605,11.572 C 8.5535,11.4895 8.838,11.381 9.112,11.2485 l 0.48,0.912 C 9.248,12.3355 8.886,12.472 8.5125,12.568 l -0.252,-0.996 z m 1.043,-0.4325 c 0.264,-0.1435 0.516,-0.3235 0.744,-0.5155 l 0.6845,0.7675 c -0.294,0.251 -0.6115,0.4725 -0.948,0.6605 L 9.3035,11.1395 Z M 9.064,11.008 8.62,10.0725 C 9.014,9.8655 9.3645,9.584 9.652,9.2445 l 0.803,0.648 c -0.389,0.455 -0.861,0.834 -1.391,1.1155 z M 10.5995,9.712 9.796,9.064 C 10.062,8.71 10.254,8.3055 10.36,7.876 l 1.0085,0.228 C 11.213,8.6825 10.953,9.228 10.5995,9.712 Z M 11.38,8.8 12.34,9.1605 c -0.144,0.36 -0.324,0.696 -0.5395,1.02 L 10.9595,9.592 C 11.128,9.34 11.2715,9.076 11.38,8.8 Z M 11.464,8.5725 C 11.56,8.296 11.632,7.9965 11.6805,7.6965 L 12.7,7.816 C 12.645,8.1965 12.553,8.57 12.4245,8.932 L 11.464,8.5725 Z M 11.692,3.652 10.8515,4.228 C 10.6725,3.983 10.4715,3.7545 10.252,3.544 l 0.684,-0.768 c 0.276,0.276 0.528,0.564 0.756,0.876 z M 3.1,2.764 3.784,3.532 C 3.556,3.736 3.364,3.964 3.184,4.216 L 2.344,3.628 C 2.5595,3.31 2.814,3.02 3.1,2.764 Z m -0.768,7.608 0.84,-0.576 c 0.18,0.24 0.3845,0.4685 0.6,0.6845 L 3.088,11.248 C 2.814,10.9755 2.561,10.6825 2.332,10.372 Z m 8.58,0.8645 -0.684,-0.7685 c 0.216,-0.2035 0.4205,-0.4315 0.5995,-0.672 l 0.841,0.588 c -0.2285,0.3 -0.4805,0.5875 -0.7565,0.8525 z" />
                        </svg>
                        <span>VSCO</span>
                    </button>
                    <button id="twitter-tab-btn" class="tab-btn flex-1 py-2 px-4 text-center font-semibold rounded-t-lg focus:outline-none flex items-center justify-center gap-x-2 transition-colors duration-300">
                        <svg class="w-5 h-5" fill="currentColor" viewBox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
                            <path d="M18.244 2.25h3.308l-7.227 8.26 8.502 11.24H16.17l-5.214-6.817L4.99 21.75H1.68l7.73-8.835L1.254 2.25H8.08l4.713 6.231zm-1.161 17.52h1.833L7.084 4.126H5.117z" />
                        </svg>
                        <span>Twitter</span>
                    </button>
                </div>
            </div>

            <div id="tiktok-tab-content" class="tab-content hidden">
                <div class="space-y-4">
                    <input type="url" id="tiktokUrl" placeholder="Paste TikTok video URL here..." class="w-full px-4 py-3 bg-gray-100 dark:bg-gray-700 border-2 border-transparent rounded-lg text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-pink-500 focus:border-transparent transition">
                    <button id="tiktokDownloadBtn" class="w-full bg-gradient-to-r from-cyan-500 to-pink-500 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 hover:brightness-110 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                        </svg>
                        Download
                    </button>
                </div>
                <div id="tiktok-status" class="mt-6 text-center">
                    <div id="tiktok-loader" class="hidden spinner mx-auto"></div>
                    <p id="tiktok-error" class="text-red-500 font-medium hidden"></p>
                    <div id="tiktok-results" class="mt-4 space-y-3"></div>
                </div>
            </div>

            <div id="vsco-tab-content" class="tab-content hidden">
                <div class="space-y-4">
                    <input type="url" id="vscoUrl" placeholder="Paste VSCO image/video URL here..." class="w-full px-4 py-3 bg-gray-100 dark:bg-gray-700 border-2 border-transparent rounded-lg text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-purple-500 focus:border-transparent transition">
                    <button id="vscoDownloadBtn" class="w-full bg-gradient-to-r from-purple-500 to-indigo-600 text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 hover:brightness-110 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                        </svg>
                        Download
                    </button>
                </div>
                <div id="vsco-status" class="mt-6 text-center">
                    <div id="vsco-loader" class="hidden spinner mx-auto"></div>
                    <p id="vsco-error" class="text-red-500 font-medium hidden"></p>
                    <div id="vsco-results" class="mt-4 space-y-4"></div>
                </div>
            </div>

            <div id="twitter-tab-content" class="tab-content hidden">
                <div class="space-y-4">
                    <input type="url" id="twitterUrl" placeholder="Paste X / Twitter URL here..." class="w-full px-4 py-3 bg-gray-100 dark:bg-gray-700 border-2 border-transparent rounded-lg text-gray-800 dark:text-gray-200 focus:outline-none focus:ring-2 focus:ring-gray-500 focus:border-transparent transition">
                    <button id="twitterDownloadBtn" class="w-full bg-gradient-to-r from-gray-800 to-black text-white font-bold py-3 px-4 rounded-lg transition-all duration-300 ease-in-out transform hover:scale-105 hover:brightness-110 flex items-center justify-center">
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 16v1a3 3 0 003 3h10a3 3 0 003-3v-1m-4-4l-4 4m0 0l-4-4m4 4V4" />
                        </svg>
                        Download
                    </button>
                </div>
                <div id="twitter-status" class="mt-6 text-center">
                    <div id="twitter-loader" class="hidden spinner mx-auto"></div>
                    <p id="twitter-error" class="text-red-500 font-medium hidden"></p>
                    <div id="twitter-results" class="mt-4 space-y-4"></div>
                </div>
            </div>


            <div class="text-center mt-8">
                <p class="text-xs text-gray-400 dark:text-gray-500">@Faisal Hasan - For personal use only.</p>
                <a class="text-xs text-blue-400 dark:text-gray-500" href="./about.html">Roadmap</a>
            </div>
        </div>
    </div>

    <script>
        // --- DOM Element References ---
        const tabs = {
            tiktok: {
                btn: document.getElementById('tiktok-tab-btn'),
                content: document.getElementById('tiktok-tab-content'),
                urlInput: document.getElementById('tiktokUrl'),
                downloadBtn: document.getElementById('tiktokDownloadBtn'),
                loader: document.getElementById('tiktok-loader'),
                errorEl: document.getElementById('tiktok-error'),
                resultsEl: document.getElementById('tiktok-results'),
            },
            vsco: {
                btn: document.getElementById('vsco-tab-btn'),
                content: document.getElementById('vsco-tab-content'),
                urlInput: document.getElementById('vscoUrl'),
                downloadBtn: document.getElementById('vscoDownloadBtn'),
                loader: document.getElementById('vsco-loader'),
                errorEl: document.getElementById('vsco-error'),
                resultsEl: document.getElementById('vsco-results'),
            },
            twitter: {
                btn: document.getElementById('twitter-tab-btn'),
                content: document.getElementById('twitter-tab-content'),
                urlInput: document.getElementById('twitterUrl'),
                downloadBtn: document.getElementById('twitterDownloadBtn'),
                loader: document.getElementById('twitter-loader'),
                errorEl: document.getElementById('twitter-error'),
                resultsEl: document.getElementById('twitter-results'),
            }
        };

        const baseTabClass = 'tab-btn flex-1 py-2 px-4 text-center font-semibold rounded-t-lg focus:outline-none flex items-center justify-center gap-x-2 transition-colors duration-300';
        const inactiveTabClass = 'text-gray-500 dark:text-gray-400 hover:bg-gray-100 dark:hover:bg-gray-700';

        // --- Tab Switching Logic ---
        function showTab(tabName) {
            Object.values(tabs).forEach(tab => {
                tab.content.classList.add('hidden');
                tab.btn.className = `${baseTabClass} ${inactiveTabClass}`;
            });

            // Define active classes for each tab with gradients
            const activeClasses = {
                tiktok: 'text-white bg-gradient-to-r from-cyan-500 to-pink-500',
                vsco: 'text-white bg-gradient-to-r from-purple-500 to-indigo-600',
                twitter: 'text-white bg-gradient-to-r from-gray-800 to-black',
            };

            const selectedTab = tabs[tabName];
            if (selectedTab) {
                selectedTab.content.classList.remove('hidden');
                selectedTab.btn.className = `${baseTabClass} ${activeClasses[tabName]}`;
            }
        }

        // Event Listeners for tabs
        tabs.tiktok.btn.addEventListener('click', () => showTab('tiktok'));
        tabs.vsco.btn.addEventListener('click', () => showTab('vsco'));
        tabs.twitter.btn.addEventListener('click', () => showTab('twitter'));

        // Show TikTok tab by default on page load
        document.addEventListener('DOMContentLoaded', () => showTab('tiktok'));

        // --- TikTok Downloader Logic ---
        tabs.tiktok.downloadBtn.addEventListener('click', handleTikTokDownload);

        async function handleTikTokDownload() {
            const videoUrl = tabs.tiktok.urlInput.value.trim();
            clearStatus('tiktok');

            if (!videoUrl || !videoUrl.includes('tiktok.com')) {
                showError('tiktok', 'Please enter a valid TikTok video URL.');
                return;
            }

            setLoading('tiktok', true);

            try {
                const apiUrl = `https://www.tikwm.com/api/?url=${encodeURIComponent(videoUrl)}`;
                const response = await fetch(apiUrl);
                const data = await response.json();

                if (data.code === 0 && data.data) {
                    displayTikTokResults(data.data);
                } else {
                    showError('tiktok', data.msg || 'Could not fetch video. Please check the link.');
                }
            } catch (err) {
                console.error('Fetch Error:', err);
                showError('tiktok', 'An unexpected error occurred. Please try again later.');
            } finally {
                setLoading('tiktok', false);
            }
        }

        function displayTikTokResults(videoData) {
            const resultsContainer = tabs.tiktok.resultsEl;
            if (videoData.play) {
                const noWatermarkLink = createDownloadLink(videoData.play, 'Download (No Watermark)');
                resultsContainer.appendChild(noWatermarkLink);
            }
            if (videoData.wmplay) {
                const withWatermarkLink = createDownloadLink(videoData.wmplay, 'Download (With Watermark)');
                resultsContainer.appendChild(withWatermarkLink);
            }
        }

        // --- VSCO Downloader Logic ---
        tabs.vsco.downloadBtn.addEventListener('click', handleVscoDownload);

        async function handleVscoDownload() {
            const vscoUrl = tabs.vsco.urlInput.value.trim();
            clearStatus('vsco');

            if (!vscoUrl || !vscoUrl.includes('vsco.co/')) {
                showError('vsco', 'Please enter a valid VSCO media URL.');
                return;
            }

            setLoading('vsco', true);

            try {
                const proxyUrl = `https://corsproxy.io/?${encodeURIComponent(vscoUrl)}`;
                const response = await fetch(proxyUrl);
                if (!response.ok) throw new Error(`Network response was not ok: ${response.statusText}`);

                const htmlText = await response.text();
                const mediaUrl = parseVscoMediaUrl(htmlText);

                if (mediaUrl) {
                    displayVscoMedia(mediaUrl);
                } else {
                    showError('vsco', 'Could not find media. The link may be private or invalid.');
                }
            } catch (err) {
                console.error('Fetch error:', err);
                showError('vsco', 'Failed to fetch media. The service might be temporarily down.');
            } finally {
                setLoading('vsco', false);
            }
        }

        function parseVscoMediaUrl(htmlText) {
            const doc = new DOMParser().parseFromString(htmlText, 'text/html');
            const videoTag = doc.querySelector('meta[property="og:video"]');
            if (videoTag && videoTag.content) return videoTag.content;

            const imageTag = doc.querySelector('meta[property="og:image"]');
            if (imageTag && imageTag.content) return imageTag.content.split('?')[0];

            return null;
        }

        function displayVscoMedia(url) {
            const resultsContainer = tabs.vsco.resultsEl;
            const isVideo = url.includes('.mp4');

            let mediaPreview;
            if (isVideo) {
                mediaPreview = document.createElement('video');
                mediaPreview.setAttribute('controls', true);
                const source = document.createElement('source');
                source.src = url;
                source.type = 'video/mp4';
                mediaPreview.appendChild(source);
            } else {
                mediaPreview = document.createElement('img');
                mediaPreview.src = url;
            }
            mediaPreview.className = 'w-full rounded-lg shadow-md';

            const downloadLink = createDownloadLink(url, isVideo ? 'Download Video' : 'Download Image');

            resultsContainer.appendChild(mediaPreview);
            resultsContainer.appendChild(downloadLink);
        }

        // --- Twitter Downloader Logic ---
        tabs.twitter.downloadBtn.addEventListener('click', handleTwitterDownload);

        async function handleTwitterDownload() {
            const tweetUrl = tabs.twitter.urlInput.value.trim();
            clearStatus('twitter');

            if (!tweetUrl || !(tweetUrl.includes('twitter.com') || tweetUrl.includes('x.com'))) {
                showError('twitter', 'Please enter a valid X / Twitter URL.');
                return;
            }

            setLoading('twitter', true);

            try {
                // Using fxtwitter's public API to get tweet details
                const apiUrl = tweetUrl.replace('twitter.com', 'api.fxtwitter.com').replace('x.com', 'api.fxtwitter.com');
                const response = await fetch(apiUrl);
                const data = await response.json();

                if (response.ok && data.tweet && data.tweet.media) {
                    displayTwitterResults(data.tweet.media);
                } else {
                    showError('twitter', data.message || 'Could not fetch media. The tweet may be private or deleted.');
                }
            } catch (err) {
                console.error('Fetch Error:', err);
                showError('twitter', 'An unexpected error occurred. Please try again later.');
            } finally {
                setLoading('twitter', false);
            }
        }

        function displayTwitterResults(media) {
            const resultsContainer = tabs.twitter.resultsEl;

            if (media.videos) {
                media.videos.forEach((video, index) => {
                    const downloadLink = createDownloadLink(video.url, `Download Video (${video.width}x${video.height})`);
                    resultsContainer.appendChild(downloadLink);
                });
            }

            if (media.photos) {
                media.photos.forEach((photo, index) => {
                    const img = document.createElement('img');
                    img.src = photo.url;
                    img.className = 'w-full rounded-lg shadow-md mb-2';
                    resultsContainer.appendChild(img);

                    const downloadLink = createDownloadLink(photo.url, `Download Image ${index + 1}`);
                    resultsContainer.appendChild(downloadLink);
                });
            }

            if (!media.videos && !media.photos) {
                 showError('twitter', 'No downloadable media found in this tweet.');
            }
        }

        // --- Helper Functions ---
        function createDownloadLink(url, text) {
            const link = document.createElement('a');
            link.href = url;
            link.textContent = text;
            link.setAttribute('download', '');
            link.setAttribute('target', '_blank'); // Open in new tab to start download
            link.className = `block w-full bg-green-500 hover:bg-green-600 text-white font-semibold py-2.5 px-4 rounded-lg transition duration-300 ease-in-out text-center`;
            return link;
        }

        function showError(platform, message) {
            const platformTab = tabs[platform];
            if (platformTab && platformTab.errorEl) {
                platformTab.errorEl.textContent = message;
                platformTab.errorEl.classList.remove('hidden');
            }
        }

        function clearStatus(platform) {
            const platformTab = tabs[platform];
            if (platformTab) {
                if (platformTab.resultsEl) platformTab.resultsEl.innerHTML = '';
                if (platformTab.errorEl) {
                    platformTab.errorEl.classList.add('hidden');
                    platformTab.errorEl.textContent = '';
                }
            }
        }

        function setLoading(platform, isLoading) {
            const platformTab = tabs[platform];
            if (platformTab && platformTab.loader && platformTab.downloadBtn) {
                platformTab.loader.classList.toggle('hidden', !isLoading);
                platformTab.downloadBtn.disabled = isLoading;
                platformTab.downloadBtn.classList.toggle('opacity-50', isLoading);
                platformTab.downloadBtn.classList.toggle('cursor-not-allowed', isLoading);
            }
        }
    </script>
</body>

</html>
